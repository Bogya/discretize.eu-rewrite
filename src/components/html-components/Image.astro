---
import { Picture } from "@astrojs/image/components";
import { OutputFormat } from "@astrojs/image/dist/loaders";

const { src, caption, ...attrs } = Astro.props;

const formats: OutputFormat[] = ["avif", "webp", "jpeg"];
---

<figure>
  <span class="imgWrapper">
    <Picture
      src={src}
      widths={[400, 800, 1200]}
      {...attrs}
      alt={caption}
      formats={formats}
      loading={"lazy"}
      sizes="(max-width: 400px) 10vw, (max-width: 800px) 50vw, 100vw"
    />
  </span>
  <figcaption>{caption}</figcaption>
</figure>

<style>
  img,
  picture :global(img),
  svg {
    border-radius: 0.75rem;
    width: 100%;
  }

  figcaption {
    font-family: Muli;
    font-size: 0.857143rem;
    font-weight: 400;
    line-height: 1.66;
    margin: 0;
    padding: 4px 8px 0;
    text-align: center;
  }
  .imgWrapper {
    position: relative;
    display: block;
    margin-left: auto;
    margin-right: auto;
    max-width: 627px;
  }
</style>
