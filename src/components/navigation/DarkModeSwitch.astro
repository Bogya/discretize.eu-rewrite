---
import { Icon } from "astro-icon";
---

<script>
  function addListener() {
    const darkModeButtons = document.querySelectorAll<HTMLInputElement>(
      `[id='darkModeSwitch'] input`
    );

    const currentTheme = localStorage.getItem("theme");
    if (currentTheme === "light") {
      document.body.classList.remove("dark");
      document.body.classList.add("light");

      darkModeButtons.forEach((button) => (button.checked = true));
    }
    darkModeButtons.forEach((button) =>
      button.addEventListener("change", () => {
        if (document.body.classList.contains("dark")) {
          document.body.classList.remove("dark");
          document.body.classList.add("light");
          localStorage.setItem("theme", "light");
        } else {
          document.body.classList.remove("light");
          document.body.classList.add("dark");
          localStorage.setItem("theme", "dark");
        }
      })
    );
  }
  document.addEventListener("DOMContentLoaded", addListener);
</script>

<label class="switch" id="darkModeSwitch">
  <input type="checkbox" aria-label="DarkMode Switch" />
  <span>
    <i><Icon name="mdi:bulb-on-outline" height="1rem" /></i>
  </span>
</label>
